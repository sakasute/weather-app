(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(23)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),c=a.n(n),r=a(10),i=a.n(r),s=(a(17),a(8)),o=a(4),u=a(6),l=a(5),h=a(2),f=a(7),d=a(1),m=(a(18),a(19),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(d.a)(Object(d.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(d.a)(Object(d.a)(a))),a.placeholderText="E.g. Turku, FI",a.state={cityQuery:""},a}return Object(f.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){this.setState({cityQuery:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.cityQuery,a=this.props.fetchCityWeather,n=t.split(",");2===n.length&&a(n[0],n[1]),a(n[0])}},{key:"render",value:function(){var e=this.state.cityQuery;return c.a.createElement("form",{className:"search",onSubmit:this.handleSubmit},c.a.createElement("label",{className:"card__title search__label"},"Search for a city:",c.a.createElement("input",{className:"search__text-field",type:"text",value:e,placeholder:this.placeholderText,onChange:this.handleChange})),c.a.createElement("input",{className:"search__btn",type:"submit",value:"GO!"}))}}]),t}(n.Component));function v(){return c.a.createElement("p",{className:"info-text info-text--center"},"No such city found :(")}a(20);function y(e){var t=e.data,a=e.isFavourite,n=e.toggleFavourite,r="".concat(t.name,", ").concat(t.sys.country),i=Math.round(t.main.temp),s=i>0?"+".concat(i):i,o=a?"city__fav-btn  city__fav-btn--remove":"city__fav-btn",u=a?"UNFAVOURITE":"FAVOURITE";return c.a.createElement("section",{className:"city"},c.a.createElement("h2",{className:"city__name"},r),c.a.createElement("button",{className:o,onClick:function(){return n(t.id)}},u),c.a.createElement("h3",{className:"city__temp"},s," \xb0C"))}a(21);function b(e){var t=e.favourites,a=e.selectCity,n=e.selectedCityId,r=Object.values(t).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}).map(function(e){var t=e.id,r=e.name,i=e.country,s=t===n?"favourites__item favourites__item--selected":"favourites__item";return c.a.createElement("li",{className:s,key:t,onClick:function(){return a(t,r,i)}},"".concat(r,", ").concat(i))});return c.a.createElement("ul",{className:"favourites"},r)}function p(){return c.a.createElement("p",{className:"info-text info-text--center"},"Search for a city or select one from your favourites.")}var O=a(3),j=a.n(O),g=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).fetchCityWeather=a.fetchCityWeather.bind(Object(d.a)(Object(d.a)(a))),a.parseWeatherData=a.parseWeatherData.bind(Object(d.a)(Object(d.a)(a))),a.selectCity=a.selectCity.bind(Object(d.a)(Object(d.a)(a))),a.addFavourite=a.addFavourite.bind(Object(d.a)(Object(d.a)(a))),a.removeFavourite=a.removeFavourite.bind(Object(d.a)(Object(d.a)(a))),a.toggleFavourite=a.toggleFavourite.bind(Object(d.a)(Object(d.a)(a))),a.state={owmApiKey:"295954eace9aec900796d0ba9ae013bc",units:"metric",weatherData:{},selectedCityId:"",favourites:{}},a}return Object(f.a)(t,e),Object(h.a)(t,null,[{key:"checkIfIdIsKey",value:function(e,t){return Object.keys(e).includes(t.toString())}}]),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("favourites");if(null!==e){var t=JSON.parse(e);this.setState({favourites:t})}}},{key:"fetchCityWeather",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.state,c=n.owmApiKey,r=n.units,i="http://api.openweathermap.org/data/2.5/weather?APPID=".concat(c,"&units=").concat(r),s=2===a.length?"".concat(e,",").concat(a):e;fetch(i+"&q=".concat(s)).then(function(e){return e.json()}).then(function(e){t.parseWeatherData(e)})}},{key:"parseWeatherData",value:function(e){if("404"===e.cod||"400"===e.cod)this.setState({selectedCityId:!1});else{var t=e.id;this.setState(function(a){return j()(a,{weatherData:Object(s.a)({},t,{$set:e}),selectedCityId:{$set:t}})})}}},{key:"selectCity",value:function(e,t,a){var n=this.state.weatherData[e];"undefined"===typeof n?this.fetchCityWeather(t,a):Date.now()-1e3*n.dt>36e5?this.fetchCityWeather(t,a):this.setState(function(t){return j()(t,{selectedCityId:{$set:e}})})}},{key:"toggleFavourite",value:function(e){var t=this.state,a=t.favourites,n=t.weatherData;if(this.constructor.checkIfIdIsKey(a,e))this.removeFavourite(e);else{var c=n[e],r=c.name,i=c.sys.country;this.addFavourite(e,r,i)}}},{key:"addFavourite",value:function(e,t,a){var n=this.state.favourites,c=j()(n,Object(s.a)({},e,{$set:{id:e,name:t,country:a}}));localStorage.setItem("favourites",JSON.stringify(c)),this.setState({favourites:c})}},{key:"removeFavourite",value:function(e){var t=this.state.favourites,a=j()(t,{$unset:[e]});localStorage.setItem("favourites",JSON.stringify(a)),this.setState({favourites:a})}},{key:"render",value:function(){var e,t=this.state,a=t.favourites,n=t.selectedCityId,r=t.weatherData;switch(n){case!1:e=c.a.createElement(v,null);break;case"":e=c.a.createElement(p,null);break;default:e=c.a.createElement(y,{data:r[n],isFavourite:this.constructor.checkIfIdIsKey(a,n),toggleFavourite:this.toggleFavourite})}var i=Object.keys(a).length>0?c.a.createElement(b,{favourites:a,selectCity:this.selectCity,selectedCityId:n}):c.a.createElement("p",{className:"info-text"},"To add a favourite, search for a city first!");return c.a.createElement("div",{className:"content-wrapper"},c.a.createElement("aside",{className:"sidebar card card--secondary"},c.a.createElement("h2",{className:"card__title"},"Favourites"),i),c.a.createElement("main",{className:"main-content card"},c.a.createElement(m,{fetchCityWeather:this.fetchCityWeather}),e))}}]),t}(n.Component);i.a.render(c.a.createElement(g,null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.9e82dba3.chunk.js.map