(window.webpackJsonp=window.webpackJsonp||[]).push([[0],[,,,,,,,,,,,function(e,t,a){e.exports=a(23)},,,,,,function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},function(e,t,a){},,function(e,t,a){"use strict";a.r(t);var n=a(0),r=a.n(n),c=a(10),i=a.n(c),s=(a(17),a(8)),o=a(4),u=a(6),l=a(5),h=a(2),d=a(7),f=a(1),m=(a(18),a(19),function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).handleChange=a.handleChange.bind(Object(f.a)(Object(f.a)(a))),a.handleSubmit=a.handleSubmit.bind(Object(f.a)(Object(f.a)(a))),a.placeholderText="E.g. Turku, FI",a.state={cityQuery:""},a}return Object(d.a)(t,e),Object(h.a)(t,[{key:"handleChange",value:function(e){this.setState({cityQuery:e.target.value})}},{key:"handleSubmit",value:function(e){e.preventDefault();var t=this.state.cityQuery,a=this.props.fetchCityWeather,n=t.split(",");2===n.length?a(n[0].trim(),n[1].trim()):a(n[0].trim())}},{key:"render",value:function(){var e=this.state.cityQuery;return r.a.createElement("form",{className:"search",onSubmit:this.handleSubmit,"data-testid":"search-form"},r.a.createElement("label",{className:"card__title search__label"},"Search for a city:",r.a.createElement("input",{className:"search__text-field",type:"text",value:e,placeholder:this.placeholderText,onChange:this.handleChange,"data-testid":"search-input"})),r.a.createElement("input",{className:"search__btn",type:"submit",value:"GO!","data-testid":"search-btn"}))}}]),t}(n.Component));function v(){return r.a.createElement("p",{className:"info-text info-text--center"},"No such city found :(")}a(20);function y(e){var t=e.data,a=e.isFavourite,n=e.toggleFavourite,c="".concat(t.name,", ").concat(t.sys.country),i=Math.round(t.main.temp),s=i>0?"+".concat(i):i,o=a?"city__fav-btn  city__fav-btn--remove":"city__fav-btn",u=a?"UNFAVOURITE":"FAVOURITE";return r.a.createElement("section",{className:"city"},r.a.createElement("h2",{className:"city__name"},c),r.a.createElement("button",{className:o,onClick:function(){return n(t.id)}},u),r.a.createElement("h3",{className:"city__temp"},s," \xb0C"),r.a.createElement("span",{className:"city__data-disclaimer"},"Weather data provided by"," ",r.a.createElement("a",{href:"https://openweathermap.org/",target:"_blank",rel:"noopener noreferrer"},"OpenWeatherMap")))}a(21);function b(e){var t=e.favourites,a=e.selectCity,n=e.selectedCityId,c=Object.values(t).sort(function(e,t){return e.name<t.name?-1:e.name>t.name?1:0}).map(function(e){var t=e.id,c=e.name,i=e.country,s=t===n?"favourites__item favourites__item--selected":"favourites__item";return r.a.createElement("li",{className:s,key:t,onClick:function(){return a(t,c,i)}},"".concat(c,", ").concat(i))});return r.a.createElement("ul",{className:"favourites"},c)}function p(){return r.a.createElement("p",{className:"info-text info-text--center"},"Search for a city or select one from your favourites.")}var O=a(3),g=a.n(O),j=function(e){function t(e){var a;return Object(o.a)(this,t),(a=Object(u.a)(this,Object(l.a)(t).call(this,e))).fetchCityWeather=a.fetchCityWeather.bind(Object(f.a)(Object(f.a)(a))),a.parseWeatherData=a.parseWeatherData.bind(Object(f.a)(Object(f.a)(a))),a.selectCity=a.selectCity.bind(Object(f.a)(Object(f.a)(a))),a.addFavourite=a.addFavourite.bind(Object(f.a)(Object(f.a)(a))),a.removeFavourite=a.removeFavourite.bind(Object(f.a)(Object(f.a)(a))),a.toggleFavourite=a.toggleFavourite.bind(Object(f.a)(Object(f.a)(a))),a.state={owmApiKey:"295954eace9aec900796d0ba9ae013bc",units:"metric",weatherData:{},selectedCityId:"",favourites:{}},a}return Object(d.a)(t,e),Object(h.a)(t,null,[{key:"checkIfIdIsKey",value:function(e,t){return Object.keys(e).includes(t.toString())}}]),Object(h.a)(t,[{key:"componentDidMount",value:function(){var e=localStorage.getItem("favourites");if(null!==e){var t=JSON.parse(e);this.setState({favourites:t})}}},{key:"fetchCityWeather",value:function(e){var t=this,a=arguments.length>1&&void 0!==arguments[1]?arguments[1]:"",n=this.state,r=n.owmApiKey,c=n.units,i="https://api.openweathermap.org/data/2.5/weather?APPID=".concat(r,"&units=").concat(c),s=2===a.length?"".concat(e,",").concat(a):e;fetch(i+"&q=".concat(s)).then(function(e){return e.json()}).then(function(e){t.parseWeatherData(e)})}},{key:"parseWeatherData",value:function(e){if("404"===e.cod||"400"===e.cod)this.setState({selectedCityId:!1});else{var t=e.id;this.setState(function(a){return g()(a,{weatherData:Object(s.a)({},t,{$set:e}),selectedCityId:{$set:t}})})}}},{key:"selectCity",value:function(e,t,a){var n=this.state.weatherData[e];"undefined"===typeof n?this.fetchCityWeather(t,a):Date.now()-1e3*n.dt>36e5?this.fetchCityWeather(t,a):this.setState(function(t){return g()(t,{selectedCityId:{$set:e}})})}},{key:"toggleFavourite",value:function(e){var t=this.state,a=t.favourites,n=t.weatherData;if(this.constructor.checkIfIdIsKey(a,e))this.removeFavourite(e);else{var r=n[e],c=r.name,i=r.sys.country;this.addFavourite(e,c,i)}}},{key:"addFavourite",value:function(e,t,a){var n=this.state.favourites,r=g()(n,Object(s.a)({},e,{$set:{id:e,name:t,country:a}}));localStorage.setItem("favourites",JSON.stringify(r)),this.setState({favourites:r})}},{key:"removeFavourite",value:function(e){var t=this.state.favourites,a=g()(t,{$unset:[e]});localStorage.setItem("favourites",JSON.stringify(a)),this.setState({favourites:a})}},{key:"render",value:function(){var e,t=this.state,a=t.favourites,n=t.selectedCityId,c=t.weatherData;switch(n){case!1:e=r.a.createElement(v,null);break;case"":e=r.a.createElement(p,null);break;default:e=r.a.createElement(y,{data:c[n],isFavourite:this.constructor.checkIfIdIsKey(a,n),toggleFavourite:this.toggleFavourite})}var i=Object.keys(a).length>0?r.a.createElement(b,{favourites:a,selectCity:this.selectCity,selectedCityId:n}):r.a.createElement("p",{className:"info-text"},"To add a favourite, search for a city first!");return r.a.createElement("div",{className:"content-wrapper"},r.a.createElement("aside",{className:"sidebar card card--secondary","data-testid":"favourites-sidebar"},r.a.createElement("h2",{className:"card__title"},"Favourites"),i),r.a.createElement("main",{className:"main-content card"},r.a.createElement(m,{fetchCityWeather:this.fetchCityWeather}),e))}}]),t}(n.Component);i.a.render(r.a.createElement(j,null),document.getElementById("root"))}],[[11,1,2]]]);
//# sourceMappingURL=main.4499ea49.chunk.js.map